<head>
  <meta charset="utf-8"/>
  <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/blockly/9.2.0/blockly.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/blockly/9.2.0/blocks.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/blockly/9.2.0/javascript.min.js"></script> -->
  <script src="https://unpkg.com/blockly/blockly.min.js"></script>
  <!-- <script src="blockly.min.js"></script>
  <script src="blocks.min.js"></script>
  <script src="javascript.min.js"></script> -->
  <!-- <script src="blockly-samples-master/plugins/block-plus-minus/src/index.js"></script> -->
  <!-- <script src="blocklify/blockly/blockly_compressed.js"></script> -->
  <script src="custom_category.js"></script>
  <!-- <script src="custom_renderer.js"></script> -->
  <script src="generate_blocks.js"></script>
  <script src="ja.js"></script>             <!-- 日本語化 -->
  <script src="acorn_interpreter.js"></script>
  <script src="https://code.jquery.com/jquery-3.6.2.js"></script>
  <!-- <script src="jquery-3.6.2.js"></script> -->
  <script src="CustomBlocksJSON.js"></script>
  <script src="CustomBlocksJavascript.js"></script>
  <script src="bi_blockly.js"></script>
  <script src="bi_blockly_javascript.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.35.0/codemirror.js"></script>
  <script src="https://codemirror.net/mode/javascript/javascript.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.35.0/addon/hint/show-hint.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.35.0/addon/hint/javascript-hint.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/acorn/5.5.3/acorn.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/acorn/5.5.3/acorn_loose.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/acorn/5.5.3/walk.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/xml-js@1.6.11/dist/xml-js.min.js"></script>
  <!-- <script src="codemirror.js"></script>
  <script src="javascript.js"></script>
  <script src="acorn.js"></script>
  <script src="acorn_loose.js"></script>
  <script src="walk.js"></script> -->
  <script src="google-closure-library/closure/goog/base.js"></script>
  <script src="./js2blocks-test.js"></script>
  <!-- <script src="blocklify/core/blocklify.js"></script> -->
  <!-- <link rel="stylesheet" href="https://unpkg.com/destyle.css@4.0.0/destyle.css"> -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.35.0/codemirror.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/6.65.7/theme/darcula.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/6.65.7/addon/hint/show-hint.min.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
  <!-- <link rel="stylesheet" href="codemirror.css">
  <link rel="stylesheet" href="darcula.min.css">
  <link rel="stylesheet" href="css2.css" /> -->
  <title>Katatsumuri</title>
  <link rel="icon" href="favicon.ico">
  <link rel="stylesheet" href="style-editor.css">
  <script src="https://www.gstatic.com/firebasejs/5.8.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/5.8.1/firebase-firestore.js"></script>

</head>
<body>
  <header>
    <img src="icon.png">
    <div class="menu">
      <ul class="menu_lists">
          <li class="menu_list">
            <p id="file_menu">ファイル</p>
            <ul class="dropdown_lists" id="file_dropdown">
              <li class="dropdown_list"><p id="new_file">新規</p></li>
              <hr>
              <li class="dropdown_list"><p id="load_computer">インポート</p></li>
              <li class="dropdown_list"><p id="save_computer">ダウンロード</p></li>
              <hr>
              <li class="dropdown_list"><p id="load_browser">開く</p></li>
              <li class="dropdown_list"><p id="overwrite_browser">上書き保存</p></li>
              <li class="dropdown_list"><p id="save_browser">名前をつけて保存</p></li>
              <li class="dropdown_list"><label for="auto_save">
                <p><input type="checkbox" id="auto_save" name="auto_save" checked><span>自動でブラウザに保存</span></p>
              </label></li>
              <hr>
              <li class="dropdown_list"><p id="delete_project">このプロジェクトを削除</p></li>
            </ul>
          </li>
          <li class="menu_list">
            <p id="edit_menu">編集</p>
            <ul class="dropdown_lists" id="edit_dropdown">
              <li class="dropdown_list"><p id="undo">元に戻す</p></li>
              <li class="dropdown_list"><p id="redo">やり直す</p></li>
              <hr>
              <li class="dropdown_list"><label for="auto_code_create">
                <p><input type="checkbox" id="auto_code_create" name="auto_code_create" checked><span>自動でコードを生成</span></p>
              </label></li>
              <li class="dropdown_list"><p id="create_code">ブロックをコードに反映</p></li>
              <hr>
              <li class="dropdown_list"><label for="turbo_mode">
                <p><input type="checkbox" id="turbo_mode" name="turbo_mode"><span>ターボモード</span></p>
              </label></li>
              <!-- <hr>
              <li class="dropdown_list"><p>
                <input type="checkbox" id="auto_block_create" name="auto_block_create"><label for="auto_block_create">自動でブロックを生成</label>
              </p></li> -->
              <!-- <li class="dropdown_list"><p id="create_block">コードをブロックに反映</p></li> -->
            </ul>
          </li>
          <li class="menu_list">
            <p id="create_block">コードをブロックに反映</p>
          </li>
      </ul>
    </div>
    <input type="text" placeholder="filename" value="Untitled" id="filename">
    <div id="share">
      <span class="material-symbols-outlined share_icon">
        share
        </span>
    </div>
  </header>
  <div id="blocklyArea">
    <div id="blocklyDiv" style="position: absolute"></div>
  </div>

  <xml id="toolbox" style="display: none">
    <category name="論理" colour="%{BKY_LOGIC_HUE}" css-icon="customIcon">

      <block type="logic_boolean"></block>
      <block type="logic_compare">
        <value name="A">
          <shadow type="math_number">
            <field name="NUM">1</field>
          </shadow>
        </value>
        <value name="B">
          <shadow type="math_number">
            <field name="NUM">1</field>
          </shadow>
        </value>
      </block>
      <block type="logic_negate">
        <value name="BOOL">
          <shadow type="logic_boolean">
            <field name="BOOL">true</field>
          </shadow>
        </value>
      </block>
      <block type="logic_operation">
        <value name="A">
          <shadow type="logic_boolean">
            <field name="BOOL">true</field>
          </shadow>
        </value>
        <value name="B">
          <shadow type="logic_boolean">
            <field name="BOOL">true</field>
          </shadow>
        </value>
      </block>
      <block type="controls_if">
      </block>
    </category>
    <category name="ループ" colour="%{BKY_LOOPS_HUE}" css-icon="customIcon">
      <block type="start_block"></block>
      <block type="simple_for">
        <value name="NUM">
          <shadow type="math_number">
            <field name="NUM">5</field>
          </shadow>
        </value>
      </block>
      <block type="controls_for">
        <value name="FROM">
          <shadow type="math_number">
            <field name="NUM">1</field>
          </shadow>
        </value>
        <value name="TO">
          <shadow type="math_number">
            <field name="NUM">10</field>
          </shadow>
        </value>
        <value name="BY">
          <shadow type="math_number">
            <field name="NUM">1</field>
          </shadow>
        </value>
      </block>
      <block type="controls_whileUntil">
        <value name="BOOL">
          <shadow type="logic_boolean">
            <field name="BOOL">TRUE</field>
          </shadow>
        </value>
      </block>
      <block type="controls_repeat_ext">
        <value name="TIMES">
          <shadow type="math_number">
            <field name="NUM">5</field>
          </shadow>
        </value>
      </block>
      <block type="controls_forEach">
      </block>
      <block type="controls_flow_statements">
      </block>
    </category>
    <category name="計算" colour="%{BKY_MATH_HUE}" css-icon="customIcon" >
      <block type="math_number"></block>
      <block type="math_arithmetic">
        <value name="A">
          <shadow type="math_number">
            <field name="NUM">1</field>
          </shadow>
        </value>
        <value name="B">
          <shadow type="math_number">
            <field name="NUM">1</field>
          </shadow>
        </value>
      </block>
      <block type="math_modulo">
        <value name="DIVIDEND">
          <shadow type="math_number">
            <field name="NUM">5</field>
          </shadow>
        </value>
        <value name="DIVISOR">
          <shadow type="math_number">
            <field name="NUM">3</field>
          </shadow>
        </value>
      </block>
      <block type="math_random_int">
        <value name="FROM">
          <shadow type="math_number">
            <field name="NUM">1</field>
          </shadow>
        </value>
        <value name="TO">
          <shadow type="math_number">
            <field name="NUM">5</field>
          </shadow>
        </value>
      </block>
      <block type="math_random_float">
      </block>
      <block type="math_round">
        <value name="NUM">
          <shadow type="math_number">
            <field name="NUM">5</field>
          </shadow>
        </value>
      </block>
      <block type="math_single">
        <value name="NUM">
          <shadow type="math_number">
            <field name="NUM">5</field>
          </shadow>
        </value>
      </block>
      <block type="math_trig">
        <value name="NUM">
          <shadow type="math_number">
            <field name="NUM">5</field>
          </shadow>
        </value>
      </block>
      <block type="math_number_property">
        <value name="NUMBER_TO_CHECK">
          <shadow type="math_number">
            <field name="NUM">5</field>
          </shadow>
        </value>
      </block>
      <block type="math_on_list">
      </block>
      <block type="math_constant">
      </block>
      <block type="math_constrain">
        <value name="VALUE">
          <shadow type="math_number">
            <field name="NUM">50</field>
          </shadow>
        </value>
        <value name="LOW">
          <shadow type="math_number">
            <field name="NUM">1</field>
          </shadow>
        </value>
        <value name="HIGH">
          <shadow type="math_number">
            <field name="NUM">100</field>
          </shadow>
        </value>
      </block>
    </category>
    <category name="文字列" colour="%{BKY_TEXTS_HUE}" css-icon="customIcon">
      <block type="output">
        <value name="output">
          <shadow type="text">
            <field name="TEXT">abc</field>
          </shadow>
        </value>
      </block>
      <block type="text"></block>
      <block type="question_block">
        <value name="TEXT">
          <shadow type="text">
            <field name="TEXT">abc?</field>
          </shadow>
        </value>
      </block>
      <block type="variables_get">
        <field name="VAR">answer</field>
      </block>
      <block type="text_join">
        <value name="ADD0">
          <shadow type="text">
            <field name="TEXT">abc</field>
          </shadow>
        </value>
        <value name="ADD1">
          <shadow type="text">
            <field name="TEXT">def</field>
          </shadow>
        </value>
      </block>
      <block type="text_append">
        <value name="TEXT">
          <shadow type="text">
            <field name="TEXT">abc</field>
          </shadow>
        </value>
      </block>
      <block type="text_length">
        <value name="VALUE">
          <shadow type="text">
            <field name="TEXT">abc</field>
          </shadow>
        </value>
      </block>
      <block type="text_isEmpty">
        <value name="VALUE">
          <shadow type="text">
            <field name="TEXT"></field>
          </shadow>
        </value>
      </block>
      <block type="text_indexOf">
        <value name="FIND">
          <shadow type="text">
            <field name="TEXT">abc</field>
          </shadow>
        </value>
        <value name="VALUE">
          <shadow type="text">
            <field name="TEXT">abc</field>
          </shadow>
        </value>
      </block>
      <block type="text_charAt">
        <value name="VALUE">
          <shadow type="text">
            <field name="TEXT">abc</field>
          </shadow>
        </value>
        <value name="AT">
          <shadow type="math_number">
            <field name="NUM">1</field>
          </shadow>
        </value>
      </block>
      <block type="text_getSubstring">
        <value name="STRING">
          <shadow type="text">
            <field name="TEXT">abc</field>
          </shadow>
        </value>
        <value name="AT1">
          <shadow type="math_number">
            <field name="NUM">1</field>
          </shadow>
        </value>
        <value name="AT2">
          <shadow type="math_number">
            <field name="NUM">3</field>
          </shadow>
        </value>
      </block>
      <block type="text_changeCase">
        <value name="TEXT">
          <shadow type="text">
            <field name="TEXT">abc</field>
          </shadow>
        </value>
      </block>
      <block type="text_count">
        <value name="SUB">
          <shadow type="text">
            <field name="TEXT">abc</field>
          </shadow>
        </value>
        <value name="TEXT">
          <shadow type="text">
            <field name="TEXT">abc</field>
          </shadow>
        </value>
      </block>
      <block type="text_changeCase">
        <value name="TEXT">
          <shadow type="text">
            <field name="TEXT">abc</field>
          </shadow>
        </value>
      </block>
      <block type="text_replace">
        <value name="FROM">
          <shadow type="text">
            <field name="TEXT">abc</field>
          </shadow>
        </value>
        <value name="TO">
          <shadow type="text">
            <field name="TEXT">abc</field>
          </shadow>
        </value>
        <value name="TEXT">
          <shadow type="text">
            <field name="TEXT">abc</field>
          </shadow>
        </value>
      </block>
      <block type="text_reverse">
        <value name="TEXT">
          <shadow type="text">
            <field name="TEXT">abc</field>
          </shadow>
        </value>
      </block>
      <block type="text_prompt_ext">
        <value name="TEXT">
          <shadow type="text">
            <field name="TEXT">abc?</field>
          </shadow>
        </value>
      </block>
    </category>
    <category name="配列" colour="%{BKY_LISTS_HUE}" css-icon="customIcon">
      <block type="lists_create_empty"></block>
      <block type="lists_create_with"></block>
      <block type="lists_repeat">
        <value name="ITEM">
          <shadow type="text">
            <field name="TEXT">abc</field>
          </shadow>
        </value>
        <value name="NUM">
          <shadow type="math_number">
            <field name="NUM">5</field>
          </shadow>
        </value>
      </block>
      <block type="lists_getIndex">
        <value name="AT">
          <shadow type="math_number">
            <field name="NUM">1</field>
          </shadow>
        </value>
      </block>
      <block type="lists_setIndex">
        <value name="AT">
          <shadow type="math_number">
            <field name="NUM">1</field>
          </shadow>
        </value>
        <value name="TO">
          <shadow type="text">
            <field name="TEXT">abc</field>
          </shadow>
        </value>
      </block>
      <block type="lists_split">
        <value name="DELIM">
          <shadow type="text" id="gEe$8,:d.VjrC%.yBU4h">
            <field name="TEXT">,</field>
          </shadow>
        </value>
      </block>
      <block type="lists_indexOf">
        <value name="FIND">
          <shadow type="text">
            <field name="TEXT">abc</field>
          </shadow>
        </value>
      </block>
      <block type="lists_sort"></block>
      <block type="lists_reverse"></block>
      <block type="lists_length"></block>
      <block type="lists_isEmpty"></block>
    </category>

    <category name="変数" custom="VARIABLE" colour="0" css-icon="customIcon">
    </category>
    <category name="関数" custom="PROCEDURE" colour="290" css-icon="customIcon">
    </category>
    <category name="コード" colour="60" css-icon="customIcon">
      <block type="bi_comment"></block>
      <block type="bi_assignment"></block>
      <block type="bi_assignment_return"></block>
      <block type="bi_math_arithmetic"></block>
      <block type="bi_logic_compare"></block>
      <block type="bi_logic_operation"></block>
      <block type="bi_try_catch"></block>
      <block type="bi_catch"></block>
      <block type="bi_throw"></block>
      <block type="bi_yield"></block>
      <block type="bi_yield_return"></block>
      <!-- <block type="bi_export"></block> -->
      <!-- <block type="bi_import"></block> -->
      <!-- <block type="bi_import_as"></block> -->
      <block type="bi_code_part"></block>
      <block type="bi_code_line"></block>
      <block type="bi_access_field"></block>
      <block type="bi_set_to"></block>
      <block type="bi_for"></block>
      <block type="bi_for_in"></block>
      <block type="bi_switch"></block>
      <block type="bi_case"></block>
      <block type="bi_continue"></block>
      <block type="bi_break"></block>
      <!-- <block type="bi_s1"></block> -->
      <block type="bi_call"></block>
      <block type="bi_call_return"></block>
      <block type="bi_direct_call_editable"></block>
      <block type="bi_direct_call_editable_return"></block>
      <block type="bi_call_editable"></block>
      <block type="bi_call_editable_return"></block>
      <block type="bi_function_return"></block>
      <block type="bi_function"></block>
      <block type="bi_return"></block>
      <!-- <block type="bi_maps_set"></block>
      <block type="bi_maps_get"></block> -->
      <block type="bi_var"></block>
      <block type="bi_var_name"></block>
      <block type="bi_new"></block>
      <block type="bi_anonymous_class"></block>
      <block type="bi_class"></block>
      <block type="bi_static"></block>
      <block type="bi_get"></block>
      <block type="bi_set"></block>
      <block type="bi_field"></block>
      <block type="bi_field_return"></block>
      <block type="bi_string_return"></block>
      <block type="bi_index"></block>
      <!-- <block type="bi_adaptor"></block>
      <block type="bi_statement"></block> -->
      <block type="bi_unary"></block>
      <block type="bi_unary_return"></block>
      <block type="bi_unary_postfix"></block>
      <block type="bi_unary_postfix_return"></block>
      <block type="bi_spread"></block>
      <block type="bi_parenthesis"></block>
      <block type="maps_create"></block>
      <block type="maps_create_with"></block>
    </category>
  </xml>

  <!-- <pre><code class="language-javascript" id="codebox" >output('hello world');</code></pre> -->
  <div class="blocklyworkspace-resizer"></div>
  <textarea id="codebox"></textarea>
  <div class="editor-resizer"></div>
  <textarea id="codeoutput"></textarea>
  <button id="execution"><span class="material-symbols-outlined">play_arrow</span></button>
  <button id="consoleclear"><span class="material-symbols-outlined">close</span></button>

  <div id="open_dialog_background">
    <div id="open_dialog">
      <div id="file_lists">
      </div>
      <div class="buttons">
        <button id="open_dialog_newfile">新しいプロジェクトを作成</button>
        <button id="open">開く</button>
        <button id="cancel">キャンセル</button>
      </div>
    </div>
  </div>
  <div id="error_dialog_background">
    <div id="error_dialog">
      <h2>ブロックに変換できませんでした</h2>
      <p>エラー内容</p>
      <textarea id="error_text"></textarea>
      <div class="buttons">
        <button id="close">閉じる</button>
      </div>
    </div>
  </div>
  <div id="share_dialog_background">
    <div id="share_dialog">
      <h2>共有</h2>
      <div id="link_create">
        <button id="create_link_btn">リンクを作成</button>
        <p>リンクを知っている全員がアクセスできる状態になります</p>
      </div>
      <div class="share_info">
        <!-- <div class="selectBox">
          <div class="selectBox__output material-symbols-outlined"></div>
          <div class="selectBox__selector">
            <div class="selectBox__selectorItem" data-select="editor">編集者</div>
            <div class="selectBox__selectorItem" data-select="reader">閲覧者</div>
          </div>
          <select name="role">
            <option value="editor">編集者</option>
            <option value="reader">閲覧者</option>
          </select>
        </div> -->
        <div class="link">
          <p class="link_field">https://xxxx</p>
          <button id="link_copy">
            <span class="material-symbols-outlined">
              content_copy
            </span>
          </button>
        </div>
      </div>
      <div class="buttons">
        <button id="ok">OK</button>
      </div>
    </div>
  </div>
  <script src="script-editor.js"></script>
</body>